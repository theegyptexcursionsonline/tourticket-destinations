<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="format-detection" content="telephone=no, date=no, address=no, email=no">
    <title>Booking Confirmation - {{companyName}}</title>
    <style>
        body { margin: 0; padding: 0; width: 100% !important; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; font-family: 'Helvetica Neue', Arial, sans-serif; background: #eef2f7; color: #0f172a; }
        table { border-collapse: collapse; }
        img { border: 0; outline: none; display: block; max-width: 100%; }
        a { color: {{primaryColor}}; text-decoration: none; }

        .wrapper { width: 100%; padding: 32px 0; background: #eef2f7; }
        .container { max-width: 680px; width: 100%; background: #fff; border-radius: 36px; overflow: hidden; box-shadow: 0 35px 70px rgba(15,23,42,0.2); }
        
        .header { text-align: center; padding: 24px 32px; background: {{secondaryColor}}; }
        .header img { max-height: 48px; margin: 0 auto; }
        .header-text { color: #fff; font-size: 14px; margin: 8px 0 0; }
        
        .success-header { text-align: center; padding: 40px 32px 0; }
        .status-icon { width: 76px; height: 76px; border-radius: 999px; margin: 0 auto 18px; background: radial-gradient(circle at 30% 30%, #34d399, #059669); color: #fff; font-size: 38px; line-height: 76px; font-weight: 700; }
        .success-title { font-size: 30px; margin: 0; font-weight: 800; color: #0f172a; }
        .success-text { color: #475569; font-size: 16px; margin: 12px 0 0; }

        .ticket-card { margin: 32px; border: 1px solid #e2e8f0; border-radius: 30px; overflow: hidden; box-shadow: inset 0 0 0 1px rgba(226,232,240,0.4); }
        .ticket-gradient { height: 6px; background: linear-gradient(90deg, {{primaryColor}}, {{accentColor}}); }
        .ticket-body { padding: 32px; }
        .badges { display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap; }
        .badge { display: inline-block; padding: 6px 14px; border-radius: 999px; font-size: 11px; letter-spacing: 1px; font-weight: 700; text-transform: uppercase; }
        .badge-confirmed { background: #d1fae5; color: #047857; }
        .badge-soft { background: #e2e8f0; color: #475569; }
        .tour-title { font-size: 24px; margin: 0 0 6px; font-weight: 800; color: #0f172a; }
        .tour-option { margin: 0 0 4px; color: {{primaryColor}}; font-weight: 600; }
        .booking-reference { margin: 0; font-size: 13px; letter-spacing: 1px; text-transform: uppercase; color: #94a3b8; font-weight: 600; }
        .ticket-date { text-align: right; }
        .date-pill { border: 1px solid #e2e8f0; border-radius: 22px; padding: 12px; width: 90px; text-align: center; }
        .date-day { font-size: 11px; letter-spacing: 1px; color: {{primaryColor}}; font-weight: 700; }
        .date-number { font-size: 30px; font-weight: 800; color: #0f172a; line-height: 1.1; }
        .date-month { font-size: 12px; letter-spacing: 1px; color: #475569; font-weight: 600; }

        .info-grid { display: flex; flex-wrap: wrap; border: 1px solid #e2e8f0; border-radius: 20px; padding: 20px; gap: 16px; margin-top: 24px; }
        .info-grid > div { flex: 1 1 120px; }
        .label { font-size: 11px; text-transform: uppercase; letter-spacing: 1px; color: #94a3b8; margin: 0 0 6px; font-weight: 700; }
        .value { font-size: 16px; font-weight: 700; margin: 0; color: #0f172a; }
        .value.mono { font-family: 'SFMono-Regular', Menlo, monospace; letter-spacing: 0.5px; }
        .status { display: flex; align-items: center; gap: 6px; }
        .status-dot { width: 8px; height: 8px; border-radius: 50%; background: #22c55e; display: inline-block; }

        .countdown-card { background: linear-gradient(135deg, {{secondaryColor}}, #1e293b); border-radius: 22px; padding: 20px; margin-top: 24px; color: #fff; text-align: center; }
        .countdown-label { margin: 0 0 12px; text-transform: uppercase; font-size: 11px; letter-spacing: 1px; color: rgba(255,255,255,0.7); }
        .countdown-grid { display: flex; justify-content: center; gap: 18px; }
        .countdown-unit { min-width: 70px; }
        .count-value { font-size: 28px; font-weight: 800; }
        .count-caption { font-size: 11px; letter-spacing: 1px; text-transform: uppercase; color: rgba(255,255,255,0.7); }

        .meta-row { display: flex; gap: 20px; margin-top: 24px; flex-wrap: wrap; }
        .meta-row > div { flex: 1 1 220px; border: 1px dashed #e2e8f0; border-radius: 18px; padding: 16px; }

        .section { margin: 0 32px 24px; border: 1px solid #e2e8f0; border-radius: 28px; padding: 24px; background: #fff; }
        .section-title { font-size: 15px; font-weight: 800; color: #0f172a; margin: 0 0 14px; }
        .info-table { width: 100%; }
        .info-label { width: 30%; font-size: 13px; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px; padding: 10px 0; }
        .info-value { font-size: 15px; font-weight: 600; color: #0f172a; padding: 10px 0; }

        .pickup { background: linear-gradient(135deg, rgba(254,243,199,0.65), rgba(253,230,138,0.65)); border-color: #fbbf24; }
        .pickup-map { margin-top: 16px; border-radius: 18px; overflow: hidden; border: 1px solid rgba(251,191,36,0.4); }

        .order-item { display: flex; align-items: center; gap: 16px; border: 1px solid #e2e8f0; border-radius: 18px; padding: 16px; margin-bottom: 12px; }
        .order-thumb { width: 64px; height: 64px; border-radius: 16px; overflow: hidden; background: #e2e8f0; flex-shrink: 0; }
        .order-thumb img { width: 100%; height: 100%; object-fit: cover; }
        .order-details { flex: 1; min-width: 0; }
        .order-title { font-weight: 700; margin: 0; color: #0f172a; }
        .order-meta { font-size: 13px; color: #94a3b8; margin: 4px 0; }
        .order-option { font-size: 12px; font-weight: 600; color: {{primaryColor}}; }
        .order-price { font-weight: 800; font-size: 16px; color: #0f172a; }

        .pricing-card { border: 1px solid #e2e8f0; border-radius: 18px; padding: 18px; }
        .pricing-row { display: flex; justify-content: space-between; font-size: 14px; color: #475569; margin-bottom: 6px; }
        .pricing-row.discount { color: #047857; font-weight: 600; }
        .pricing-total { display: flex; justify-content: space-between; font-size: 18px; font-weight: 800; margin-top: 12px; color: #0f172a; }

        .note { background: linear-gradient(135deg, #fff7ed, #ffedd5); border-color: #fed7aa; }
        .body-text { margin: 0; font-size: 15px; color: #7c2d12; }

        .qr-card { border: 1px dashed #e2e8f0; border-radius: 22px; padding: 24px; text-align: center; }
        .qr-card img { width: 160px; height: 160px; margin: 0 auto 12px; border-radius: 16px; border: 1px solid #e2e8f0; padding: 12px; background: #fff; }

        .cta { text-align: center; }
        .btn { display: inline-block; padding: 16px 48px; border-radius: 999px; background: {{primaryColor}}; color: #fff; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; box-shadow: 0 18px 35px rgba(0,0,0,0.2); }

        .footer { padding: 24px; text-align: center; border-top: 1px solid #e2e8f0; background: #f8fafc; }
        .footer-text { margin: 0; font-size: 12px; color: #94a3b8; }
        .footer-links { margin: 12px 0 0; }
        .footer-links a { color: #64748b; margin: 0 8px; font-size: 12px; }
        .social-links { margin: 16px 0 0; }
        .social-links a { display: inline-block; margin: 0 6px; }

        @media screen and (max-width: 640px) {
            .container { border-radius: 0; }
            .ticket-card, .section { margin: 20px; padding: 20px; }
            .info-grid { flex-direction: column; }
            .meta-row { flex-direction: column; }
            .btn { display: block; width: 100%; }
        }
    </style>
</head>
<body>
    <table role="presentation" class="wrapper" width="100%" cellpadding="0" cellspacing="0">
        <tr>
            <td align="center">
                <table role="presentation" class="container" width="680" cellpadding="0" cellspacing="0">
                    <!-- Header with Logo -->
                    <tr>
                        <td>
                            <div class="header">
                                {{#if companyLogo}}
                                <img src="{{companyLogo}}" alt="{{companyName}}">
                                {{else}}
                                <div style="color: #fff; font-size: 24px; font-weight: 800;">{{companyName}}</div>
                                {{/if}}
                            </div>
                        </td>
                    </tr>
                    
                    <tr>
                        <td>
                            <div class="success-header">
                                <div class="status-icon">✓</div>
                                <h1 class="success-title">Booking Confirmed!</h1>
                                <p class="success-text">Hi {{customerName}}, your adventure is locked in. Save this email for a ticket that mirrors the booking confirmation page.</p>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="ticket-card">
                                <div class="ticket-gradient"></div>
                                <div class="ticket-body">
                                    <table width="100%" cellpadding="0" cellspacing="0">
                                        <tr>
                                            <td class="ticket-info">
                                                <div class="badges">
                                                    <span class="badge badge-confirmed">Confirmed</span>
                                                    <span class="badge badge-soft">E-ticket</span>
                                                </div>
                                                <h2 class="tour-title">{{tourTitle}}</h2>
                                                {{#if bookingOption}}<p class="tour-option">{{bookingOption}}</p>{{/if}}
                                                <p class="booking-reference">Booking {{bookingId}}</p>
                                            </td>
                                            {{#if dateBadge}}
                                            <td class="ticket-date" valign="top">
                                                <div class="date-pill">
                                                    <div class="date-day">{{dateBadge.dayLabel}}</div>
                                                    <div class="date-number">{{dateBadge.dayNumber}}</div>
                                                    <div class="date-month">{{dateBadge.monthLabel}}</div>
                                                </div>
                                            </td>
                {{/if}}
                                        </tr>
                                    </table>

                                    <div class="info-grid">
                                        <div>
                                            <p class="label">Booking ID</p>
                                            <p class="value mono">{{bookingId}}</p>
                    </div>
                                        <div>
                                            <p class="label">Time</p>
                                            <p class="value">{{bookingTime}}</p>
                        </div>
                                        <div>
                                            <p class="label">Guests</p>
                                            <p class="value">{{participants}}</p>
                    </div>
                                        <div>
                                            <p class="label">Status</p>
                                            <p class="value status"><span class="status-dot"></span>Confirmed</p>
                </div>
            </div>

                                    {{#if timeUntil}}
                                    <div class="countdown-card">
                                        <p class="countdown-label">Your adventure begins in</p>
                                        <div class="countdown-grid">
                                            <div class="countdown-unit">
                                                <div class="count-value">{{timeUntil.days}}</div>
                                                <div class="count-caption">Days</div>
                                            </div>
                                            <div class="countdown-unit">
                                                <div class="count-value">{{timeUntil.hours}}</div>
                                                <div class="count-caption">Hours</div>
                                            </div>
                                            <div class="countdown-unit">
                                                <div class="count-value">{{timeUntil.minutes}}</div>
                                                <div class="count-caption">Mins</div>
                                            </div>
                                        </div>
                </div>
                        {{/if}}

                                    <div class="meta-row">
                                        <div>
                                            <p class="label">Date</p>
                                            <p class="value">{{bookingDate}}</p>
                    </div>
                                        {{#if meetingPoint}}
                                        <div>
                                            <p class="label">Meeting Point</p>
                                            <p class="value">{{meetingPoint}}</p>
                            </div>
                                        {{/if}}
                            </div>
                        </div>
                    </div>
                                </td>
                            </tr>

                    <tr>
                        <td>
                            <div class="section">
                                <div class="section-title">Guest Information</div>
                                <table class="info-table">
                                    <tr><td class="info-label">Name</td><td class="info-value">{{customerName}}</td></tr>
                                    <tr><td class="info-label">Email</td><td class="info-value"><a class="link" href="mailto:{{customerEmail}}">{{customerEmail}}</a></td></tr>
                                    {{#if customerPhone}}
                                    <tr><td class="info-label">Phone</td><td class="info-value">{{customerPhone}}</td></tr>
                                    {{/if}}
                                </table>
                            </div>
                                </td>
                            </tr>

                    {{#if hotelPickupDetails}}
                    <tr>
                        <td>
                            <div class="section pickup">
                                <div class="section-title">Hotel Pickup</div>
                                <p class="body-text">{{hotelPickupDetails}}</p>
                                {{#if hotelPickupMapImage}}
                                <div class="pickup-map">
                                    {{#if hotelPickupMapLink}}
                                    <a href="{{hotelPickupMapLink}}">
                                        <img src="{{hotelPickupMapImage}}" alt="Pickup location map">
                                    </a>
                                    {{else}}
                                    <img src="{{hotelPickupMapImage}}" alt="Pickup location map">
                                    {{/if}}
                                </div>
                                {{/if}}
                    </div>
                        </td>
                    </tr>
                    {{/if}}

                    {{#if orderedItems}}
                    <tr>
                        <td>
                            <div class="section">
                                <div class="section-title">Order Summary</div>
                                {{#each orderedItems}}
                                <div class="order-item">
                                    {{#if image}}
                                    <div class="order-thumb">
                                        <img src="{{image}}" alt="{{title}}">
                                    </div>
                                    {{/if}}
                                    <div class="order-details">
                                        <div class="order-title">{{title}}</div>
                                        <div class="order-meta">Adults: {{adults}}{{#if children}} · Children: {{children}}{{/if}}{{#if infants}} · Infants: {{infants}}{{/if}}</div>
                                        {{#if bookingOption}}<div class="order-option">{{bookingOption}}</div>{{/if}}
                                    </div>
                                    <div class="order-price">{{totalPrice}}</div>
                                </div>
                                {{/each}}
                    </div>
                        </td>
                    </tr>
                    {{/if}}

                    {{#if pricingDetails}}
                    <tr>
                        <td>
                            <div class="section">
                                <div class="section-title">Pricing Breakdown</div>
                                <div class="pricing-card">
                                    <div class="pricing-row"><span>Subtotal</span><span>{{pricingDetails.subtotal}}</span></div>
                                    <div class="pricing-row"><span>Service fee</span><span>{{pricingDetails.serviceFee}}</span></div>
                                    <div class="pricing-row"><span>Taxes & fees</span><span>{{pricingDetails.tax}}</span></div>
                                    {{#if pricingDetails.discount}}<div class="pricing-row discount"><span>Discount</span><span>-{{pricingDetails.discount}}</span></div>{{/if}}
                                    <div class="pricing-total"><span>Total</span><span>{{pricingDetails.total}}</span></div>
                                </div>
                    </div>
                        </td>
                    </tr>
                    {{/if}}

                    {{#if specialRequests}}
                    <tr>
                        <td>
                            <div class="section note">
                                <div class="section-title">Special Requests</div>
                                <p class="body-text">"{{specialRequests}}"</p>
                </div>
                        </td>
                    </tr>
                    {{/if}}

                    <tr>
                        <td>
                            <div class="section">
                                <div class="section-title">Digital Pass</div>
                                <div class="qr-card">
                                    {{#if qrCodeCid}}
                                    <img src="cid:{{qrCodeCid}}" alt="Booking QR Code">
                                    <p class="body-text" style="color: #475569;">Show this QR code at the meeting point or <a class="link" href="{{verificationUrl}}">view your booking online</a>.</p>
                                    {{else}}
                                    <p class="body-text" style="color: #475569;">You can revisit your booking any time at <a class="link" href="{{baseUrl}}/user/bookings">{{baseUrl}}/user/bookings</a>.</p>
                                    {{/if}}
                                </div>
                            </div>
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <div class="section cta">
                                <a class="btn" href="{{baseUrl}}/user/bookings">View My Booking</a>
                                {{#if contactPhone}}
                                <p class="success-text" style="margin-top:16px;">Need changes? Reply to this email or WhatsApp <a href="https://wa.me/{{contactPhone}}">{{contactPhone}}</a>.</p>
                                {{/if}}
                            </div>
                        </td>
                    </tr>

                    <!-- Footer -->
                    <tr>
                        <td>
                            <div class="footer">
                                <p class="footer-text">© {{year}} {{companyName}}</p>
                                <div class="footer-links">
                                    {{#if website}}<a href="{{website}}">Website</a>{{/if}}
                                    {{#if contactEmail}}<a href="mailto:{{contactEmail}}">Contact Us</a>{{/if}}
                                </div>
                                {{#if (or facebookUrl instagramUrl twitterUrl)}}
                                <div class="social-links">
                                    {{#if facebookUrl}}<a href="{{facebookUrl}}">Facebook</a>{{/if}}
                                    {{#if instagramUrl}}<a href="{{instagramUrl}}">Instagram</a>{{/if}}
                                    {{#if twitterUrl}}<a href="{{twitterUrl}}">Twitter</a>{{/if}}
                                </div>
                                {{/if}}
                            </div>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</body>
</html>
